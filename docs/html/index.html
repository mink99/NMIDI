<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NMidi: MidiPort Libary</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="minklogo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NMidi
   &#160;<span id="projectnumber">0.0</span>
   </div>
   <div id="projectbrief">yet another midi Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">MidiPort Libary </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>based on ArduMidi C++ FILE v2.1 by Pecacheu</p>
<p>NMidi Libary C++ FILE v2.1 by Mink</p>
<h1><a class="anchor" id="basic_sec"></a>
Basic Concepts</h1>
<h2><a class="anchor" id="step1"></a>
callbacks</h2>
<h2><a class="anchor" id="step2"></a>
multi instance</h2>
<h2><a class="anchor" id="step3"></a>
portable</h2>
<h1><a class="anchor" id="reading_sec"></a>
Reading and Processing</h1>
<p>Declaring a MidiPort Instance</p>
<div class="fragment"><div class="line">MidiPort midi = MidiPort(Serial1);</div>
</div><!-- fragment --><p>Instanciating a MidiPort Instance</p>
<div class="fragment"><div class="line">Serial1.begin(31250);</div>
<div class="line">midi.begin();</div>
<div class="line"> </div>
<div class="line">midi.setThruMode(<a class="code" href="namespacenmidi.html#a736fc9ea91f7d5df8c60d3e89bb79ed1a9c17c7e70e7697e74841797f8819dff5">FORWARD_ALL</a>);</div>
<div class="line">midi.handleMidiEvent(processData);</div>
</div><!-- fragment --><p>Integrating a MidiPort Instance</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> serialEvent()</div>
<div class="line">{</div>
<div class="line">    midi.scanForData();</div>
<div class="line">}</div>
</div><!-- fragment --><p> ... or ... </p><div class="fragment"><div class="line"><span class="keywordtype">void</span>  loop()</div>
<div class="line">{</div>
<div class="line">    midi.scanForData();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Serial Event is called when data is available. this may lead to a more smooth performance, but also to more "globals"</p>
<h2><a class="anchor" id="step5"></a>
main processing : handleMidiEvent()</h2>
<h2><a class="anchor" id="step6"></a>
specific processing : handle_xxx()</h2>
<h1><a class="anchor" id="filtering_sec"></a>
Filtering Input</h1>
<p>under construction ...</p>
<h1><a class="anchor" id="writing_sec"></a>
Writing Midi Data</h1>
<p>under construction ...</p>
<h2><a class="anchor" id="writing_sec2"></a>
Running Status</h2>
<p>The MIDI spec allows for a MIDI message to be sent without its Status byte (ie, just its data bytes are sent) as long as the previous, transmitted message had the same Status. This is referred to as running status. Running status is simply a clever scheme to maximize the efficiency of MIDI transmission (by removing extraneous Status bytes). The basic philosophy of running status is that a device must always remember the last Status byte that it received (except for RealTime), and if it doesn't receive a Status byte when expected (on subsequent messages), it should assume that it's dealing with a running status situation. A device that generates MIDI messages should always remember the last Status byte that it sent (except for RealTime), and if it needs to send another message with the same Status, the Status byte may be omitted.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> enableRunningStatus(<span class="keywordtype">boolean</span> enable = <span class="keyword">true</span>)</div>
</div><!-- fragment --><h1><a class="anchor" id="sysex_sec"></a>
Writing SYSEX and NRPN</h1>
<h2><a class="anchor" id="writing_sec3"></a>
writing sysex</h2>
<p>writing sysex is basically three steps: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> beginTransferSysex(<span class="keywordtype">byte</span>,<span class="keywordtype">byte</span> ); <span class="comment">//0xf0</span></div>
<div class="line"><span class="keywordtype">void</span> transferSysex(<span class="keywordtype">byte</span>[], uint8_t); </div>
<div class="line"><span class="keywordtype">void</span> endTransferSysex(); <span class="comment">//0xf7</span></div>
</div><!-- fragment --><p>you can repeat transferSysex multiple times in a loop for eg doing block transfer while reading from sd you may test the timing, no precautios are taken within nmidi. this is not midi-ox :)</p>
<p>example : </p><div class="fragment"><div class="line">beginTransferSysex(0x41,0x10 ); <span class="comment">//0xf0</span></div>
<div class="line"><span class="keywordtype">int</span> x = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (...)</div>
<div class="line">{</div>
<div class="line">    data = read(...);</div>
<div class="line">    transferSysex(data, size);</div>
<div class="line">}</div>
<div class="line">endTransferSysex();</div>
</div><!-- fragment --><h2><a class="anchor" id="writing_sec4"></a>
writing sysex the roland way</h2>
<p>special functions are availoable for roland devices (0x41) and their checksum management</p>
<p>uint8_t transferSysexR(byte[], uint8_t size , uint8_t prev ); //0xf7</p>
<p>example : </p><div class="fragment"><div class="line">beginTransferSysex(0x41,0x10 ); <span class="comment">//0xf0</span></div>
<div class="line"><span class="keywordtype">int</span> x = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (...)</div>
<div class="line">{</div>
<div class="line">    data = read(...);</div>
<div class="line">    x = transferSysexR(data, size, x);</div>
<div class="line">}</div>
<div class="line">endTransferSysexR(x);</div>
</div><!-- fragment --><p>while in a loop, you provide the data, but also read the result of the function ans provide it either to the nex call or to void endTransferSysexR(byte ); //0xf7</p>
<h1><a class="anchor" id="session_sec"></a>
Writing Midi Clock and MTC : Sessions</h1>
<p>under construction ...</p>
<h1><a class="anchor" id="util_sec"></a>
Utilities</h1>
<p>under construction ...</p>
<h1><a class="anchor" id="dp_sec"></a>
Design Patterns</h1>
<h2><a class="anchor" id="dp_sec1"></a>
multiple handleMidiEvent() for status changes</h2>
<h2><a class="anchor" id="dp_sec2"></a>
design considerations for multiple ports</h2>
<h1><a class="anchor" id="poratability_sec"></a>
Considerations about Portability</h1>
<p>under construction ... </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacenmidi_html_a736fc9ea91f7d5df8c60d3e89bb79ed1a9c17c7e70e7697e74841797f8819dff5"><div class="ttname"><a href="namespacenmidi.html#a736fc9ea91f7d5df8c60d3e89bb79ed1a9c17c7e70e7697e74841797f8819dff5">nmidi::FORWARD_ALL</a></div><div class="ttdoc">Any traffic received on MIDI IN is immediately forwarded to MIDI OUT. Warning, may cause a feedback l...</div><div class="ttdef"><b>Definition:</b> NMIDI.h:132</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
